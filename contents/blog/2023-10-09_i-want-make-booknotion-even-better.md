---
title: BookNotionã‚’æ›´ã«ç¥ã‚¢ãƒ—ãƒªã«ã—ãŸã„ ãã®ï¼‘
slug: i-want-make-booknotion-even-better
date: 2023-10-09
modified_time: 2023-10-09
description: BookNotionã‚’ã‚ˆã‚Šä¾¿åˆ©ã«ã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½æ‹¡å¼µã«ã¤ã„ã¦ã€‚
icon: ğŸ“”
icon_url: /icons/notebook_with_decorative_cover_flat.svg
tags:
  - JavaScript
  - Notion
  - NotionAPI
---
## ã¯ã˜ã‚ã«
[BookNotion](https://booknotion.site/)ã¨ã„ã†ã‚¢ãƒ—ãƒªã‚’ã”å­˜çŸ¥ã§ã™ã‹ï¼Ÿ
> Kindleã®ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚’ã‹ã‚“ãŸã‚“ã«Notionã«ä¿å­˜ã§ãã‚‹èª­æ›¸è¨˜éŒ²ã‚¢ãƒ—ãƒª(å…¬å¼ã‚µã‚¤ãƒˆã‚ˆã‚Š)

ã™ã”ãã–ã£ãã‚Šèª¬æ˜ã™ã‚‹ã¨ã€ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ãŸç®‡æ‰€ã‚’Notionã«ã¾ã¨ã‚ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚¢ãƒ—ãƒªã§ã™ã€‚
è¿½åŠ ã™ã‚‹ã¨ãã‚‚ãƒ¡ãƒ¢ã¨ã—ã¦è‡ªåˆ†ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¥ã‚Œã‚‹ã“ã¨ã‚„ã€ã‚¿ã‚°ä»˜ã‘ã‚‚ã§ãã¾ã™ã€‚

è¿½åŠ ã—ãŸã‚ã¨ã¯Notionå†…ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã¾ã¨ã‚ã‚‰ã‚Œã¾ã™ã€‚
é»„è‰²ãå¡—ã‚Šã¤ã¶ã—ã¦ã„ã‚‹ã®ã¯ã€å®Ÿéš›ã«ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ãŸå†…å®¹ãŒã¯ã„ã£ã¦ã„ã¾ã™ã€‚
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3351724/602b5ee9-e749-e197-3d68-bbd5a6a2feb3.png)

## å•é¡Œç‚¹

ã“ã®ã¾ã¾ã§ã‚‚æ—¢ã«ç¥ã‚¢ãƒ—ãƒªãªã‚“ã§ã™ãŒã€å€‹äººçš„ãªå•é¡Œç‚¹ãŒã‚ã‚Šã¾ã™ã€‚
ãã‚Œã¯æ›¸ç±å˜ä½ã§ãƒšãƒ¼ã‚¸ã«ã¾ã¨ã‚ã‚‰ã‚Œãªã„ã“ã¨ã§ã™ã€‚
ç†æƒ³ã¨ã—ã¦ã¯ã€æœ¬Aã¨ã„ã†æ–°è¦ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã—ã¦ãƒšãƒ¼ã‚¸å†…ã«ãƒã‚¤ãƒ©ã‚¤ãƒˆã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¨ã¦ã¾ã¨ã‚ãŸã„ã®ã§ã™:grimacing:

## ãªã‚‰ã¤ãã‚Œã°ã‚ˆãã­ï¼Ÿ

Notionã«ã¯APIãŒæä¾›ã•ã‚Œã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã§ä½œã£ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã™ã€‚
ã‚¢ãƒ—ãƒªã«ã™ã‚‹æ°—ã¯ãªã„ã®ã§ã€ã¨ã‚Šã‚ãˆãšè‡ªåˆ†ç”¨ã«ãƒšãƒ¼ã‚¸å˜ä½ã§ã¾ã¨ã‚ã‚‹ã“ã¨ãŒã§ãã‚Œã°OKã¨ã—ã¾ã™ã€‚

## å®Ÿéš›ã«ã‚„ã£ã¦ã¿ãŸ

ãƒ•ãƒ­ãƒ¼ã¨ã—ã¦ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚‹ã¨æ€ã£ã¦ã„ã¾ã™ã€‚
1. BookNotionã§è¿½åŠ ã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰æœ¬ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—ã™ã‚‹
1. æœ¬ã®ã‚¿ã‚¤ãƒˆãƒ«ã«ç´ã¥ããƒã‚¤ãƒ©ã‚¤ãƒˆã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’å–å¾—ã™ã‚‹
1. 1.ã§å–å¾—ã—ãŸæœ¬ã®ã‚¿ã‚¤ãƒˆãƒ«åã§æ–°è¦ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã™ã‚‹
1. 2.ã§å–å¾—ã—ãŸãƒã‚¤ãƒ©ã‚¤ãƒˆã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’ã€ä½œæˆã—ãŸãƒšãƒ¼ã‚¸å†…ã«è¿½åŠ ã™ã‚‹

ã²ã¨ã¾ãšã¯APIã§å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’å®Ÿéš›ã«è¿½åŠ ã§ãã‚‹ã‹ã©ã†ã‹ã‚’è©¦ã—ãŸã„ã®ã§ã€1ä»¶ã ã‘å–å¾—ãƒ»ä½œæˆã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

``` ts
import dotenv from 'dotenv';

dotenv.config();

const API_URL = 'https://api.notion.com/v1';
const API_KEY = process.env.API_KEY;
const DATABASE_ID = process.env.DATABASE_ID;
const PAGE_URL = process.env.PAGE_URL;
const HEADERS = {
  Authorization: `Bearer ${API_KEY}`,
  'Content-Type': 'application/json',
  'Notion-Version': '2022-06-28',
};

//                      BookNotionã®Book Titleã«ç´ã¥ã„ãŸåå‰ãŒã¯ã„ã‚‹
const selectBookName = 'æ­¦å™¨ã«ãªã‚‹å“²å­¦ã€€äººç”Ÿã‚’ç”ŸãæŠœããŸã‚ã®å“²å­¦ãƒ»æ€æƒ³ã®ã‚­ãƒ¼ã‚³ãƒ³ã‚»ãƒ—ãƒˆ50';

const createNewPage = async (pageTitle: string, highlight: string, comment: string) => {
  try {
    const response = await fetch(`${API_URL}/pages`, {
      method: 'POST',
      headers: HEADERS,
      body: JSON.stringify({
        parent: {
          type: 'page_id',
          page_id: PAGE_URL,
        },
        properties: {
          title: {
            type: 'title',
            title: [
              {
                type: 'text',
                text: { content: pageTitle },
              },
            ],
          },
        },
      }),
    });
    const data = await response.json();
    console.log(`Page created: ${data.id}`);

    const blocks = [
      {
        type: 'heading_2',
        heading_2: {
          rich_text: [
            {
              type: 'text',
              text: { content: highlight },
            },
          ],
        },
      },
      {
        type: 'paragraph',
        paragraph: {
          rich_text: [
            {
              type: 'text',
              text: { content: comment },
            },
          ],
        },
      },
    ];
    await appendBlockChildren(data.id, blocks);
  } catch (error) {
    console.error(error);
  }
};
const appendBlockChildren = async (pageId: string, blocks: any[]) => {
  try {
    const response = await fetch(`${API_URL}/blocks/${pageId}/children`, {
      method: 'PATCH',
      headers: HEADERS,
      body: JSON.stringify({ children: blocks }),
    });
    const data = await response.json();
  } catch (error) {
    console.error(error);
  }
};

const getBookProperties = async (selectBookName: string): Promise<BookProperties | {}> => {
  try {
    const response = await fetch(`${API_URL}/databases/${DATABASE_ID}/query`, {
      method: 'POST',
      headers: HEADERS,
    });
    const data = await response.json();

    const filteredPages = data.results.filter((page: any) => {
      const bookTitle = page.properties['ğŸ“™  Book Title'].select.name;
      return bookTitle === selectBookName;
    });

    if (filteredPages.length > 0) {
      const highlight: string = filteredPages[0].properties['ğŸ“  Highlight'].title[0].plain_text;
      const comment: string = filteredPages[0].properties['ğŸ’¬  Comment'].rich_text[0].plain_text;
      return { highlight, comment };
    } else {
      console.log('No pages found with the specified book title.');
      return {};
    }
  } catch (error) {
    console.error(error);
    return {};
  }
};

getBookProperties(selectBookName).then((properties: BookProperties | {}) => {
  if ('highlight' in properties && 'comment' in properties) {
    const { highlight, comment } = properties as BookProperties;
    createNewPage(selectBookName, highlight, comment);
  }
});
```

## å‹•ã‹ã—ã¦ã¿ãŸ

ã“ã‚“ãªæ„Ÿã˜ã§è¿½åŠ ã•ã‚Œã¾ã™ã€‚
ãƒã‚¤ãƒ©ã‚¤ãƒˆã®å†…å®¹ã¯è¦‹å‡ºã—2(## )ã§è¿½åŠ ã—ãŸãŸã‚ã€å¤§ãããªã£ã¦ã„ã¾ã™ã€‚

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3351724/f79e2da0-c590-e82a-6c59-af9d1525cfe5.png)

## æ¬¡å›

ãƒã‚¤ãƒ©ã‚¤ãƒˆã¨ã‚³ãƒ¡ãƒ³ãƒˆã‚’å…¨éƒ¨å–å¾—ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

