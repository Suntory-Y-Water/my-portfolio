---
import BaseLayout from '@/layouts/BaseLayout.astro';
import PageHeader from '@/components/shared/page-header.astro';
import { Card, CardContent } from '@/components/ui/card';
import { siteConfig } from '@/config/site';
import { getTagSlug } from '@/config/tag-slugs';
import { getAllTags } from '@/lib/markdown';
import { absoluteUrl, cn } from '@/lib/utils';

const PAGE_TITLE = 'すべてのタグ';
const PAGE_DESCRIPTION =
  'ブログ記事で使われているすべてのタグ一覧です。興味のあるタグをクリックして関連記事を探せます。';

const tags = await getAllTags();
const sortedTags = tags.sort((a, b) => a.localeCompare(b, 'ja'));

const canonicalUrl = absoluteUrl('/tags');
---

<BaseLayout
  title={PAGE_TITLE}
  description={PAGE_DESCRIPTION}
  ogImage={siteConfig.ogImage}
  canonicalUrl={canonicalUrl}
>
  <section class='container mx-auto px-4 py-8' data-pagefind-ignore>
    <PageHeader heading={PAGE_TITLE} text={PAGE_DESCRIPTION} />

    {
      sortedTags.length > 0 ? (
        <div class='grid grid-cols-[repeat(auto-fill,minmax(180px,1fr))] gap-4 pt-4'>
          {sortedTags.map((tag) => (
            <a href={`/tags/${getTagSlug(tag)}`} class='no-underline'>
              <Card
                client:load
                className={cn(
                  'flex h-full items-center justify-center p-4 text-center transition-all duration-200',
                  'hover:shadow-md hover:ring-1 hover:ring-primary/50',
                  'focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2',
                )}
              >
                <CardContent client:load className='p-0'>
                  <span class='font-medium text-foreground group-hover:text-primary'>
                    # {tag}
                  </span>
                </CardContent>
              </Card>
            </a>
          ))}
        </div>
      ) : (
        <p class='pt-4 text-muted-foreground'>タグが見つかりませんでした。</p>
      )
    }
  </section>
</BaseLayout>
