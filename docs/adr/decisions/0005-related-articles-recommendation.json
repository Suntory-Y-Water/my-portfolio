{
  "id": "ADR-0005",
  "timestamp": "2025-12-06T00:00:00Z",
  "title": "関連記事レコメンデーション機能の実装",
  "status": "proposed",
  "context": {
    "problem": "ブログ記事の下部に関連記事を表示することで、ユーザーの回遊性を向上させたい。記事のタグ情報を活用して、類似する記事を自動的に推薦する機能が必要。",
    "constraints": [
      "ビルド時にのみ計算を実行(ランタイムパフォーマンスを犠牲にしない)",
      "外部ライブラリへの依存を最小限に抑える",
      "バンドルサイズを軽量に保つ",
      "タグ情報のみを使用(記事本文の自然言語処理は行わない)"
    ],
    "requirements": [
      "記事間の類似度を計算する仕組み",
      "上位N件の関連記事を抽出",
      "既存のブログ詳細ページへの統合",
      "SSG(Static Site Generation)との互換性"
    ]
  },
  "decision": {
    "summary": "TF-IDF + Cosine Similarityを使用した関連記事推薦システムをビルド時に事前計算する方式を採用",
    "details": "各記事のタグをTF-IDFでベクトル化し、ベクトル間の類似度をCosine Similarityで計算する。計算はビルド時(SSG)に実施し、結果をページ生成時に利用することでランタイムのパフォーマンスを確保する。上位4件の関連記事を表示する。",
    "alternatives": [
      {
        "option": "外部ライブラリ(ml.jsなど)の使用",
        "pros": ["実装が簡単", "機械学習ライブラリの豊富な機能"],
        "cons": [
          "バンドルサイズの増加",
          "過剰な機能(タグベースのレコメンデーションには不要)",
          "依存関係の増加"
        ],
        "rejected": true,
        "reason": "バンドルサイズの増加と過剰な機能により、シンプルなタグベースのレコメンデーションには不適切"
      },
      {
        "option": "ランタイム計算",
        "pros": [
          "常に最新の計算結果を利用可能",
          "動的な記事追加に対応しやすい"
        ],
        "cons": [
          "ページ表示時のパフォーマンス悪化",
          "サーバーサイドの計算負荷増加",
          "ユーザー体験への悪影響"
        ],
        "rejected": true,
        "reason": "パフォーマンスへの悪影響が大きく、SSGの利点を損なう"
      }
    ],
    "rationale": "TF-IDFはタグの重要度を適切に評価でき、Cosine Similarityはベクトル間の類似度測定に標準的な手法として広く使われている。ビルド時計算により、ランタイムのパフォーマンスを犠牲にせず、UXを向上できる。スクラッチ実装により外部ライブラリへの依存を避け、軽量に保つことができる。",
    "consequences": [
      "ユーザーの回遊性向上",
      "ページ滞在時間の増加",
      "ビルド時間の若干の増加",
      "記事のタグ設計の重要性が増す",
      "バンドルサイズへの影響が最小限"
    ]
  },
  "implementation": {
    "affected_files": [
      "src/lib/recommend.ts",
      "src/components/feature/content/related-articles.tsx",
      "src/app/blog/[slug]/page.tsx"
    ],
    "affected_components": [
      "ブログ詳細ページ",
      "記事一覧システム",
      "関連記事表示コンポーネント"
    ],
    "code_patterns": [
      "TF-IDF計算関数",
      "Cosine Similarity計算関数",
      "レコメンド生成関数",
      "ビルド時事前計算パターン"
    ],
    "examples": [
      {
        "file": "src/lib/recommend.ts",
        "line_start": 1,
        "line_end": 100,
        "description": "TF-IDF、Cosine Similarity、レコメンド計算のコアロジック実装"
      },
      {
        "file": "src/components/feature/content/related-articles.tsx",
        "line_start": 1,
        "line_end": 50,
        "description": "関連記事を表示するReactコンポーネント"
      },
      {
        "file": "src/app/blog/[slug]/page.tsx",
        "line_start": 1,
        "line_end": 200,
        "description": "ブログ詳細ページへの関連記事統合"
      }
    ]
  },
  "metadata": {
    "tags": [
      "recommendation",
      "tf-idf",
      "cosine-similarity",
      "blog",
      "performance",
      "ssg",
      "algorithm"
    ],
    "related_adrs": [],
    "supersedes": null,
    "superseded_by": null,
    "author": "AIアシスタント",
    "reviewers": [],
    "references": [
      "https://github.com/YadaYuki/like-a-bear/tree/master/src/domain/recommend",
      "https://zenn.dev/yukiyada/articles/d5681300a7fc28"
    ]
  },
  "search_keywords": [
    "関連記事",
    "レコメンデーション",
    "recommendation",
    "TF-IDF",
    "Cosine Similarity",
    "類似度計算",
    "similarity",
    "タグベース",
    "tag-based",
    "ビルド時計算",
    "build-time",
    "SSG",
    "Static Site Generation",
    "ユーザー回遊性",
    "user engagement",
    "記事推薦",
    "article recommendation"
  ],
  "vector_embedding": null
}
