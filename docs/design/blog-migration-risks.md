# ブログ記事管理システム移行 リスク管理表

**文書番号**: RISK-2025-001
**作成日**: 2025-11-14
**バージョン**: 1.0
**ステータス**: Active

---

## 1. リスク管理の概要

### 1.1 目的
ブログ記事管理システムのMDX→Markdown移行において、発生しうるリスクを特定し、対策を講じる。

### 1.2 リスク評価基準

#### 影響度（Impact）
- **高**: プロジェクト全体に影響、移行中止の可能性
- **中**: 一部機能に影響、追加工数が発生
- **低**: 軽微な影響、容易に対処可能

#### 発生確率（Probability）
- **高**: 70%以上
- **中**: 30-70%
- **低**: 30%未満

#### 優先度（Priority）
- **クリティカル**: 影響度:高 × 発生確率:高/中
- **重要**: 影響度:高 × 発生確率:低 または 影響度:中 × 発生確率:高
- **注意**: 影響度:中 × 発生確率:中/低 または 影響度:低 × 発生確率:高
- **監視**: 影響度:低 × 発生確率:中/低

---

## 2. リスク一覧

### 🔴 クリティカルリスク

#### RISK-001: remarkプラグインの互換性問題

**カテゴリ**: 技術リスク
**影響度**: 高
**発生確率**: 中
**優先度**: クリティカル

##### リスク内容
- `remark-link-card`が期待通りに動作しない
- プラグイン同士の競合が発生する
- Next.js 15系との互換性がない

##### 影響
- LinkPreview機能が実装できない
- Phase 1でプロトタイプ検証が失敗
- 移行計画の大幅な変更が必要

##### 発生条件
- remarkプラグインがメンテナンスされていない
- Next.js/React 19との互換性がない
- unified v11との互換性がない

##### 対策（予防策）

**事前調査**:
```bash
# プラグインの最終更新日を確認
npm info remark-link-card
npm info remark-alerts

# GitHub issuesで互換性問題を検索
# https://github.com/[plugin-repo]/issues
```

**代替案の準備**:
1. カスタムremarkプラグインの開発準備
2. 既存のLinkPreviewコンポーネントロジックの抽出
3. rehypeプラグインでの実装検討

##### 対策（発生時）

**Phase 1での対応**:
- プロトタイプ検証で早期発見
- 代替プラグインの調査（`remark-embed`, `remark-oembed`等）
- カスタムプラグイン開発への切り替え（工数+4時間）

**エスカレーション基準**:
- 3種類以上のプラグインで失敗した場合、プロジェクトオーナーに報告

##### 状態
- [ ] 未発生
- [ ] 発生中
- [ ] 対策完了

---

#### RISK-002: 一括変換時のデータ損失

**カテゴリ**: データリスク
**影響度**: 高
**発生確率**: 中
**優先度**: クリティカル

##### リスク内容
- 変換スクリプトのバグで記事内容が破損する
- フロントマターが消失する
- 特殊文字・絵文字が文字化けする

##### 影響
- 記事が読めなくなる
- SEOメタデータが失われる
- ロールバックが必要になる

##### 発生条件
- 正規表現の誤り
- エンコーディングの不一致
- gray-matterのパース失敗

##### 対策（予防策）

**バックアップ**:
```bash
# 変換前にバックアップ作成
cp -r src/content/blog/ src/content/blog.backup/
git commit -m "backup: before MDX to MD conversion"
```

**段階的検証**:
1. サンプル1記事で検証
2. 2-3記事で検証
3. 全記事で実行

**変換後の検証**:
```bash
# 変換後のファイル数確認
ls src/content/blog/*.mdx | wc -l  # 13
ls content/blog/*.md | wc -l        # 13（同数か確認）

# フロントマターの検証スクリプト実行
pnpm run check:frontmatter
```

##### 対策（発生時）

**即座にロールバック**:
```bash
git restore content/blog/
git restore src/content/blog/
```

**手動修正**:
- 破損した記事を特定
- バックアップから復元
- 該当箇所のみ手動変換

##### 状態
- [ ] 未発生
- [ ] 発生中
- [ ] 対策完了

---

#### RISK-003: ビルドエラーの解決不能

**カテゴリ**: 技術リスク
**影響度**: 高
**発生確率**: 中
**優先度**: クリティカル

##### リスク内容
- Phase 3でビルドエラーが多発し解決できない
- 型エラーが大量に発生する
- ランタイムエラーが発生する

##### 影響
- 移行が完了できない
- デプロイができない
- 開発環境が使用不能になる

##### 発生条件
- unifiedパイプラインの設定ミス
- remarkプラグインの型定義不足
- Next.js 15系との互換性問題

##### 対策（予防策）

**Phase 1でのプロトタイプ検証**:
- ビルドが成功することを事前確認
- 型エラーがゼロであることを確認

**段階的実装**:
1. remarkプラグインなしでビルド
2. 1つずつプラグインを追加
3. エラー発生時は該当プラグインを特定

##### 対策（発生時）

**デバッグ手順**:
```bash
# 詳細なエラーログを出力
pnpm run build 2>&1 | tee build-error.log

# 型エラーの詳細確認
pnpm run typecheck --verbose
```

**段階的ロールバック**:
- 問題のあるプラグインを無効化
- 最小構成でビルド成功を確認
- 徐々に機能を追加

**エスカレーション基準**:
- 4時間以内に解決できない場合、技術アドバイザーに相談

##### 状態
- [ ] 未発生
- [ ] 発生中
- [ ] 対策完了

---

### 🟡 重要リスク

#### RISK-004: パフォーマンス劣化

**カテゴリ**: 性能リスク
**影響度**: 中
**発生確率**: 中
**優先度**: 重要

##### リスク内容
- ビルド時間が現状比150%を超える
- ページ表示速度が遅くなる
- LinkPreview OGP取得で遅延が発生

##### 影響
- 開発体験の低下
- ユーザー体験の低下
- SEO評価の低下

##### 発生条件
- unifiedパイプラインの処理が重い
- remarkプラグインの処理が非効率
- OGP取得がランタイム実行される

##### 対策（予防策）

**ベンチマーク計測**:
```bash
# 現状のビルド時間を計測
time pnpm run build

# 移行後のビルド時間を計測
time pnpm run build

# 比較
```

**最適化手法**:
- OGP取得はビルド時のみ（キャッシュ活用）
- remarkプラグインの並列処理
- 不要なプラグインの削除

##### 対策（発生時）

**プロファイリング**:
- Next.js Analyticsで計測
- Lighthouse スコアで評価

**チューニング**:
- remarkプラグインの設定見直し
- キャッシュ戦略の導入
- 画像最適化の強化

##### 状態
- [ ] 未発生
- [ ] 発生中
- [ ] 対策完了

---

#### RISK-005: Obsidianとの互換性問題

**カテゴリ**: 運用リスク
**影響度**: 中
**発生確率**: 中
**優先度**: 重要

##### リスク内容
- Obsidianで一部の記法がプレビューされない
- GFM Alertsが表示されない
- Wikilink（`[[]]`）との競合

##### 影響
- Obsidianでの執筆体験が低下
- プレビュー時に表示崩れが発生
- 移行の目的が達成できない

##### 発生条件
- ObsidianのMarkdownパーサーが非標準
- Obsidianプラグインとの競合
- Obsidianバージョンが古い

##### 対策（予防策）

**Obsidianバージョン確認**:
- 最新版を使用（v1.5.0以降推奨）
- GFM Alertsサポートを確認

**プラグイン導入**:
- `obsidian-admonition`（Callout用）
- `obsidian-link-preview`（LinkPreview用）

##### 対策（発生時）

**Obsidian設定の調整**:
- Strict Line Breaksを有効化
- Vimモードを無効化（競合する場合）

**代替手法**:
- Obsidian非推奨の記法を避ける
- 標準Markdown優先で執筆

##### 状態
- [ ] 未発生
- [ ] 発生中
- [ ] 対策完了

---

#### RISK-006: SEO影響（インデックス低下）

**カテゴリ**: ビジネスリスク
**影響度**: 中
**発生確률**: 低
**優先度**: 重要

##### リスク内容
- 記事URLが変わることでSEO評価が下がる
- OGP画像が表示されなくなる
- 構造化データが失われる

##### 影響
- 検索流入の減少
- SNSシェア時の見栄えが悪化
- Google Search Consoleでエラー

##### 発生条件
- URLスキームの変更（本移行では変更なし）
- OGP設定の不備
- sitemap.xmlの更新漏れ

##### 対策（予防策）

**URL維持**:
- `/blog/{slug}`形式を維持（変更なし）

**OGP確認**:
```bash
# OGP画像が生成されるか確認
curl -I https://yoursite.com/blog/ogp/add-blog-to-portfolio
```

**構造化データ確認**:
- JSON-LDが正しく出力されているか確認
- Google Rich Results Testで検証

##### 対策（発生時）

**Google Search Console対応**:
- インデックス再送信
- サイトマップ再送信
- URLインスペクションツールで確認

**モニタリング**:
- 移行後1週間はアクセス解析を監視
- 検索順位の変動を確認

##### 状態
- [ ] 未発生
- [ ] 発生中
- [ ] 対策完了

---

### 🟢 注意リスク

#### RISK-007: 既存記事の表示崩れ

**カテゴリ**: 品質リスク
**影響度**: 中
**発生確率**: 低
**優先度**: 注意

##### リスク内容
- 特殊なHTML構造が崩れる
- CSSスタイルが適用されない
- コードブロックの表示が崩れる

##### 影響
- 記事の可読性低下
- ユーザー体験の低下

##### 対策（予防策）
- Phase 4で全記事を目視確認
- スクリーンショット比較テスト

##### 対策（発生時）
- 該当記事のみ手動修正
- CSSの調整

##### 状態
- [ ] 未発生
- [ ] 発生中
- [ ] 対策完了

---

#### RISK-008: 新規タグの追加漏れ

**カテゴリ**: 運用リスク
**影響度**: 低
**発生確率**: 中
**優先度**: 注意

##### リスク内容
- 新記事で新しいタグを使用したが`tag-slugs.ts`への追加を忘れる
- `pnpm run check:tags`が失敗する

##### 影響
- ビルドエラー（CIで検知）
- タグページが404になる

##### 対策（予防策）
- CIでcheck:tagsを実行（既存）
- 新規記事作成時のチェックリスト整備

##### 対策（発生時）
- `tag-slugs.ts`に追加
- CI再実行

##### 状態
- [ ] 未発生
- [ ] 発生中
- [ ] 対策完了

---

#### RISK-009: Obsidian設定ファイルのコミット

**カテゴリ**: セキュリティリスク
**影響度**: 低
**発生確率**: 低
**優先度**: 注意

##### リスク内容
- `.obsidian/`配下の個人設定がgitにコミットされる
- プラグイン設定が共有される

##### 影響
- 開発者間の設定競合
- 個人情報の漏洩リスク

##### 対策（予防策）
- `.gitignore`に`.obsidian/`を追加済み（確認済み）

##### 対策（発生時）
- gitヒストリーから削除
- `.gitignore`の再確認

##### 状態
- [x] 対策完了（.gitignoreに既に記載あり）

---

### 🔵 監視リスク

#### RISK-010: remarkプラグインの非推奨化

**カテゴリ**: 保守リスク
**影響度**: 低
**発生確率**: 低
**優先度**: 監視

##### リスク内容
- 使用しているremarkプラグインがメンテナンス停止
- 将来のNode.js/Next.jsバージョンで動作しなくなる

##### 影響
- 長期的な保守コストの増加

##### 対策
- 半年に1回、プラグインの更新状況を確認
- 代替プラグインの調査

##### 状態
- [ ] 未発生（監視中）

---

## 3. リスク管理プロセス

### 3.1 リスク監視
- **頻度**: 各フェーズ終了時
- **担当**: プロジェクトリーダー
- **方法**: リスク一覧を確認し、状態を更新

### 3.2 エスカレーション基準
- クリティカルリスクが発生した場合、即座にプロジェクトオーナーに報告
- 重要リスクは4時間以内に解決できない場合、報告

### 3.3 リスク対応履歴
| 日付 | リスクID | 対応内容 | 結果 | 対応者 |
|------|---------|---------|------|--------|
| - | - | - | - | - |

---

## 4. 関連ドキュメント

- [要件定義書](./blog-migration-requirements.md)
- [移行計画書](./blog-migration-plan.md)
- [受入基準書](./blog-migration-acceptance-criteria.md)

---

## 5. 変更履歴

| バージョン | 日付 | 変更内容 | 変更者 |
|-----------|------|---------|--------|
| 1.0 | 2025-11-14 | 初版作成 | Claude Code |
