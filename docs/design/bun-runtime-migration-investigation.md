# Bun Runtime ç§»è¡Œèª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ

## 1. Overview

### ç§»è¡Œã®ç›®çš„
- ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ãƒ“ãƒ«ãƒ‰æ™‚é–“ã®é«˜é€ŸåŒ–
- CI/CDå®Ÿè¡Œæ™‚é–“ã®çŸ­ç¸®
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®å‰Šæ¸›
- é–‹ç™ºä½“é¨“ã®å‘ä¸Š

### èª¿æŸ»æ—¥æ™‚
2025-11-15

### èª¿æŸ»å¯¾è±¡ç’°å¢ƒ
- **ç¾åœ¨**: pnpm + Node.js 20
- **ç§»è¡Œå…ˆ**: Bun (latest)
- **Next.js**: 15.5.2
- **React**: 19.2.0
- **ãƒ‡ãƒ—ãƒ­ã‚¤å…ˆ**: Vercel

---

## 2. Compatibility Status

### 2.1 Next.js 15.5 + Bun äº’æ›æ€§

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: âœ… å…¬å¼å¯¾å¿œ**

- Next.js 15.5ã¯Bunã‚’å…¬å¼ã‚µãƒãƒ¼ãƒˆ
- SSGã€ISRã€API Routesã™ã¹ã¦å‹•ä½œç¢ºèªæ¸ˆã¿
- Turbopackä½¿ç”¨æ™‚ã‚‚å•é¡Œãªã—

### 2.2 Vercel ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå¯¾å¿œçŠ¶æ³

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹: ğŸŸ¡ Betaå¯¾å¿œï¼ˆ2025å¹´10æœˆã€œï¼‰**

- Vercelä¸Šã§Bunãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒãƒ™ãƒ¼ã‚¿ç‰ˆã¨ã—ã¦åˆ©ç”¨å¯èƒ½
- `vercel.json`ã§æ˜ç¤ºçš„ã«æŒ‡å®šå¯èƒ½
- ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³åˆ©ç”¨å®Ÿç¸¾ã‚ã‚Šï¼ˆBunãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆè‡ªä½“ãªã©ï¼‰

### 2.3 ä¸»è¦ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®äº’æ›æ€§ãƒãƒˆãƒªã‚¯ã‚¹

| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ | äº’æ›æ€§ | å‚™è€ƒ |
|-----------|-------|------|
| React 19 | âœ… | å®Œå…¨å¯¾å¿œ |
| Next.js 15.5 | âœ… | å…¬å¼å¯¾å¿œ |
| Biome | âœ… | Bunå…¬å¼ã‚µãƒãƒ¼ãƒˆ |
| TypeScript | âœ… | Bunãƒã‚¤ãƒ†ã‚£ãƒ–å®Ÿè¡Œ |
| unified/remark/rehype | âœ… | Node.js APIäº’æ› |
| rehype-pretty-code | âœ… | å•é¡Œãªã— |
| rehype-link-card | âœ… | ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å‹•ä½œç¢ºèªå¿…è¦ |
| rehype-code-copy-button | âœ… | ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å‹•ä½œç¢ºèªå¿…è¦ |
| gray-matter | âœ… | å•é¡Œãªã— |
| next-themes | âœ… | å•é¡Œãªã— |

---

## 3. Performance Expectations

### 3.1 ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æ¯”è¼ƒï¼ˆæœŸå¾…å€¤ï¼‰

| æŒ‡æ¨™ | ç¾åœ¨ (pnpm) | äºˆæƒ³ (Bun) | æ”¹å–„ç‡ |
|------|------------|-----------|--------|
| ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« | 30-40ç§’ | 10-15ç§’ | **2-3x** |
| é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹• | 3-5ç§’ | 2-3ç§’ | **30-50%** |
| ãƒ“ãƒ«ãƒ‰æ™‚é–“ | 60-80ç§’ | 50-70ç§’ | **10-20%** |
| CIå®Ÿè¡Œæ™‚é–“ | 2-3åˆ† | 1.5-2åˆ† | **20-30%** |
| ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ | 500-700MB | 150-300MB | **æœ€å¤§70%å‰Šæ¸›** |

### 3.2 Vercel ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆ

- Vercelã®[å…¬å¼ãƒ–ãƒ­ã‚°](https://vercel.com/blog/bun-support)ã«ã‚ˆã‚‹ã¨å¹³å‡28%ã®ãƒ¬ã‚¤ãƒ†ãƒ³ã‚·å‰Šæ¸›ã‚’å ±å‘Š
- ã‚³ãƒ¼ãƒ«ãƒ‰ã‚¹ã‚¿ãƒ¼ãƒˆæ™‚é–“ã®æ”¹å–„ãŒæœŸå¾…ã§ãã‚‹

---

## 4. Migration Impact

### 4.1 CI/CD (GitHub Actions)

**å¤‰æ›´ãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«**: `.github/workflows/*.yml`

#### Before
```yaml
- uses: actions/setup-node@v4
  with:
    node-version: 20

- uses: pnpm/action-setup@v4
  with:
    version: 9

- run: pnpm install --frozen-lockfile
- run: pnpm run build
- run: pnpm run test
```

#### After
```yaml
- uses: oven-sh/setup-bun@v2
  with:
    bun-version: latest

- run: bun install --frozen-lockfile
- run: bun run build
- run: bun run test
```

**å½±éŸ¿åº¦**: ğŸŸ¡ ä¸­
- ã™ã¹ã¦ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ›´æ–°ã™ã‚‹å¿…è¦ã‚ã‚Š
- setup-bunã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯å…¬å¼æä¾›
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ã‚‚å¤‰æ›´ãŒå¿…è¦

### 4.2 Scripts & Package.json

**å¤‰æ›´ãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«**: `package.json`

ã™ã¹ã¦ã®æ—¢å­˜ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ãã®ã¾ã¾å‹•ä½œã™ã‚‹è¦‹è¾¼ã¿ï¼š

```json
{
  "scripts": {
    "dev": "next dev",           // âœ… å‹•ä½œ
    "build": "next build",       // âœ… å‹•ä½œ
    "typecheck": "tsc --noEmit", // âœ… å‹•ä½œ
    "check": "biome check .",    // âœ… å‹•ä½œ
    "new-blog": "tsx scripts/create-blog-template.ts", // âœ… BunãŒãƒã‚¤ãƒ†ã‚£ãƒ–å®Ÿè¡Œ
    "check:tags": "tsx scripts/check-tags.ts"          // âœ… BunãŒãƒã‚¤ãƒ†ã‚£ãƒ–å®Ÿè¡Œ
  }
}
```

**æ³¨æ„ç‚¹**:
- `tsx`ã¯Bunã§ãƒã‚¤ãƒ†ã‚£ãƒ–ã«TypeScriptã‚’å®Ÿè¡Œã§ãã‚‹ãŸã‚ä¸è¦ã«ãªã‚‹å¯èƒ½æ€§
- ãŸã ã—äº’æ›æ€§ã®ãŸã‚æ®‹ã—ã¦ãŠã„ã¦ã‚‚å•é¡Œãªã—

**å½±éŸ¿åº¦**: ğŸŸ¢ å°
- ã‚¹ã‚¯ãƒªãƒ—ãƒˆå¤‰æ›´ã¯ä¸è¦
- `tsx`ä¾å­˜ã‚’å‰Šé™¤ã™ã‚‹ã‹ã¯ä»»æ„

### 4.3 Vercel Deployment

**å¤‰æ›´ãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«**: `vercel.json` (æ–°è¦ä½œæˆ)

```json
{
  "buildCommand": "bun run build",
  "installCommand": "bun install",
  "framework": "nextjs"
}
```

ã¾ãŸã¯ã€Vercel Dashboardã§è¨­å®š:
- Build Command: `bun run build`
- Install Command: `bun install`

**å½±éŸ¿åº¦**: ğŸŸ¢ å°
- è¨­å®šè¿½åŠ ã®ã¿
- ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚‚å®¹æ˜“

### 4.4 Custom Rehype Plugins

**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/lib/rehype-link-card.ts`
- `src/lib/rehype-code-copy-button.ts`

**äº’æ›æ€§ç¢ºèªé …ç›®**:
- Node.js `fs` API â†’ Bunã‚‚äº’æ›ã‚ã‚Š
- `unified`/`hast` API â†’ å•é¡Œãªã—
- `visit` (unist-util-visit) â†’ å•é¡Œãªã—

**å½±éŸ¿åº¦**: ğŸŸ¢ å°
- Node.jsäº’æ›APIã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚å‹•ä½œã™ã‚‹è¦‹è¾¼ã¿
- Phase 1ã§ãƒ­ãƒ¼ã‚«ãƒ«æ¤œè¨¼å¿…é ˆ

---

## 5. Risk Assessment

### 5.1 ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«: ğŸŸ¡ ä¸­ãƒªã‚¹ã‚¯

### 5.2 ä¸»è¦ãƒªã‚¹ã‚¯é …ç›®

| ãƒªã‚¹ã‚¯ | å½±éŸ¿åº¦ | ç™ºç”Ÿç¢ºç‡ | è»½æ¸›ç­– |
|--------|-------|---------|--------|
| Vercel Bunãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒãƒ™ãƒ¼ã‚¿ç‰ˆ | é«˜ | ä½ | ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ—ãƒ­ã‚¤ã§å…ˆè¡Œæ¤œè¨¼ |
| ã‚«ã‚¹ã‚¿ãƒ rehypeãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®éäº’æ› | ä¸­ | ä½ | Phase 1ã§ãƒ­ãƒ¼ã‚«ãƒ«æ¤œè¨¼ |
| CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®å‹•ä½œä¸è‰¯ | ä¸­ | ä½ | Phase 2ã§æ®µéšçš„ç§»è¡Œ |
| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®éš ã‚ŒãŸéäº’æ›æ€§ | ä½ | ä½ | å…¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œç¢ºèª |
| é–‹ç™ºè€…ã®å­¦ç¿’ã‚³ã‚¹ãƒˆ | ä½ | ä¸­ | Bunã¯åŸºæœ¬çš„ã«pnpmäº’æ› |

### 5.3 è»½æ¸›ç­–

1. **æ®µéšçš„ç§»è¡Œ**: ãƒ­ãƒ¼ã‚«ãƒ« â†’ CI/CD â†’ æœ¬ç•ªã®3æ®µéš
2. **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ—ãƒ­ã‚¤æ¤œè¨¼**: Vercel Previewç’°å¢ƒã§å…ˆè¡Œç¢ºèª
3. **å³åº§ã®ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å¯èƒ½æ€§**: pnpmè¨­å®šã‚’æ®‹ã—ã¦ãŠã
4. **å…¨è‡ªå‹•ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**: ç§»è¡Œå‰å¾Œã§å…¨ãƒ†ã‚¹ãƒˆã‚¹ã‚¤ãƒ¼ãƒˆå®Ÿè¡Œ

---

## 6. Migration Plan

### Phase 1: Local Validation (æ‰€è¦æ™‚é–“: 15åˆ†)

**ç›®çš„**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®Bunå‹•ä½œç¢ºèª

```bash
# 1. Bunã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆï¼‰
curl -fsSL https://bun.sh/install | bash

# 2. ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
bun install

# 3. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèª
bun run dev

# 4. ãƒ“ãƒ«ãƒ‰ç¢ºèª
bun run build

# 5. å‹ãƒã‚§ãƒƒã‚¯
bun run typecheck

# 6. Lintãƒã‚§ãƒƒã‚¯
bun run check

# 7. ã‚¿ã‚°ãƒã‚§ãƒƒã‚¯
bun run check:tags

# 8. æ–°è¦ãƒ–ãƒ­ã‚°ä½œæˆãƒ†ã‚¹ãƒˆ
bun run new-blog test-article
```

**æˆåŠŸåŸºæº–**:
- ã™ã¹ã¦ã®ã‚³ãƒãƒ³ãƒ‰ãŒã‚¨ãƒ©ãƒ¼ãªãå®Œäº†
- ãƒ“ãƒ«ãƒ‰æˆæœç‰©ãŒæ­£å¸¸ã«ç”Ÿæˆã•ã‚Œã‚‹
- ã‚«ã‚¹ã‚¿ãƒ rehypeãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼ˆãƒªãƒ³ã‚¯ã‚«ãƒ¼ãƒ‰ã€ã‚³ãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³ï¼‰ãŒå‹•ä½œ
- é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã§ãƒ›ãƒƒãƒˆãƒªãƒ­ãƒ¼ãƒ‰ãŒæ©Ÿèƒ½

**å¤±æ•—æ™‚ã®å¯¾å¿œ**:
- ã‚¨ãƒ©ãƒ¼å†…å®¹ã‚’è¨˜éŒ²
- ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸äº’æ›æ€§ã®å†èª¿æŸ»
- å¿…è¦ã«å¿œã˜ã¦ç§»è¡Œã‚’å»¶æœŸ

---

### Phase 2: CI/CD Migration (æ‰€è¦æ™‚é–“: 30åˆ†)

**å‰ææ¡ä»¶**: Phase 1ãŒæˆåŠŸ

**æ‰‹é †**:

1. **GitHub Actionsãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æ›´æ–°**
   - `.github/workflows/ci.yml` (å­˜åœ¨ã™ã‚‹å ´åˆ)
   - setup-node â†’ setup-bun ã«å¤‰æ›´
   - pnpm â†’ bun ã«å¤‰æ›´

2. **ãƒ†ã‚¹ãƒˆãƒ–ãƒ©ãƒ³ãƒã§æ¤œè¨¼**
   ```bash
   git checkout -b test/bun-ci
   # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ç·¨é›†
   git commit -m "test: migrate CI to Bun"
   git push
   ```

3. **CIå®Ÿè¡Œç¢ºèª**
   - ã™ã¹ã¦ã®ã‚¸ãƒ§ãƒ–ãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèª
   - å®Ÿè¡Œæ™‚é–“ã®æ”¹å–„ã‚’æ¸¬å®š

**æˆåŠŸåŸºæº–**:
- ã™ã¹ã¦ã®CIã‚¸ãƒ§ãƒ–ãŒé€šé
- å®Ÿè¡Œæ™‚é–“ãŒçŸ­ç¸®ã•ã‚Œã¦ã„ã‚‹

**å¤±æ•—æ™‚ã®å¯¾å¿œ**:
- ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è§£æ
- setup-bunã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³èª¿æ•´
- å¿…è¦ã«å¿œã˜ã¦Node.jsä½µç”¨ã‚’æ¤œè¨

---

### Phase 3: Vercel Production (æ‰€è¦æ™‚é–“: 20åˆ†)

**å‰ææ¡ä»¶**: Phase 1, 2ãŒæˆåŠŸ

**æ‰‹é †**:

1. **vercel.jsonä½œæˆ**
   ```json
   {
     "buildCommand": "bun run build",
     "installCommand": "bun install"
   }
   ```

2. **ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ‡ãƒ—ãƒ­ã‚¤ã§æ¤œè¨¼**
   ```bash
   git checkout -b feat/bun-runtime
   git add vercel.json
   git commit -m "feat: enable Bun runtime on Vercel"
   git push
   ```

3. **Vercel Previewç’°å¢ƒã§ãƒ†ã‚¹ãƒˆ**
   - ãƒ“ãƒ«ãƒ‰ãƒ­ã‚°ç¢ºèª
   - å…¨ãƒšãƒ¼ã‚¸ã®è¡¨ç¤ºç¢ºèª
   - ãƒªãƒ³ã‚¯ã‚«ãƒ¼ãƒ‰å‹•ä½œç¢ºèª
   - ã‚³ãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼ãƒœã‚¿ãƒ³å‹•ä½œç¢ºèª
   - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ¸¬å®šï¼ˆLighthouseç­‰ï¼‰

4. **æœ¬ç•ªãƒãƒ¼ã‚¸**
   ```bash
   # Previewæ¤œè¨¼å®Œäº†å¾Œ
   git checkout main
   git merge feat/bun-runtime
   git push
   ```

**æˆåŠŸåŸºæº–**:
- Vercelãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸ
- ã™ã¹ã¦ã®æ©Ÿèƒ½ãŒæ­£å¸¸å‹•ä½œ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæ”¹å–„ï¼ˆã¾ãŸã¯åŒç­‰ï¼‰

**å¤±æ•—æ™‚ã®å¯¾å¿œ**:
- vercel.jsonã‚’å‰Šé™¤ã—ã¦ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯
- Vercel Dashboardã§ãƒ“ãƒ«ãƒ‰è¨­å®šã‚’ç¢ºèª
- ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰å‹•ä½œã‚’å†æ¤œè¨¼

---

## 7. Decision

### æ¨å¥¨åº¦: â­â­â­â­â˜† (4/5)

**æ¨å¥¨ç†ç”±**:
- âœ… Next.js 15.5å…¬å¼å¯¾å¿œ
- âœ… å¤§å¹…ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æ”¹å–„ãŒæœŸå¾…ã§ãã‚‹
- âœ… ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸äº’æ›æ€§ã«å•é¡Œãªã—
- âœ… æ®µéšçš„ç§»è¡ŒãŒå¯èƒ½
- âœ… ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ãŒå®¹æ˜“

**æ‡¸å¿µç‚¹**:
- âš ï¸ Vercel Bunãƒ©ãƒ³ã‚¿ã‚¤ãƒ ãŒãƒ™ãƒ¼ã‚¿ç‰ˆï¼ˆãŸã ã—å®‰å®šç¨¼åƒå ±å‘Šã‚ã‚Šï¼‰
- âš ï¸ ã‚«ã‚¹ã‚¿ãƒ rehypeãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®å®Ÿå‹•ä½œç¢ºèªãŒå¿…è¦

### Next Action

**æ¨å¥¨**: Phase 1 (Local Validation) ã‚’å®Ÿæ–½

```bash
# å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰
bun install
bun run dev
bun run build
bun run typecheck
bun run check
```

Phase 1ãŒæˆåŠŸã—ãŸã‚‰ã€Phase 2, 3ã«é€²ã‚€åˆ¤æ–­ã‚’è¡Œã†ã€‚

---

## 8. References

### å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- [Bunå…¬å¼ã‚µã‚¤ãƒˆ](https://bun.sh/)
- [Next.js with Bun](https://nextjs.org/docs/app/building-your-application/configuring/package-managers#bun)
- [Vercel Bun Runtime (Beta)](https://vercel.com/blog/bun-support)
- [Bun vs Node.js Performance Benchmarks](https://bun.sh/docs/runtime/nodejs-apis)

### å‚è€ƒè¨˜äº‹
- [Vercelå…¬å¼ãƒ–ãƒ­ã‚°: Bun Support on Vercel (2025-10)](https://vercel.com/blog/bun-support)
- [Bun 1.0 Release Notes](https://bun.sh/blog/bun-v1.0)

### GitHub
- [oven-sh/setup-bun](https://github.com/oven-sh/setup-bun) - GitHub Actionsç”¨ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
